# 象棋游戏用户使用手册

欢迎使用网络象棋游戏！本手册将详细介绍游戏的各项功能和操作方法，帮助您快速上手并享受对弈的乐趣。

## 📋 目录

- [系统要求](#系统要求)
- [安装和启动](#安装和启动)
- [界面介绍](#界面介绍)
- [游戏操作](#游戏操作)
- [象棋规则](#象棋规则)
- [高级功能](#高级功能)
- [故障排除](#故障排除)

---

## 系统要求

### 最低配置

- **操作系统**：Windows 7 / macOS 10.12 / Linux（Ubuntu 16.04或更高）
- **Java版本**：JDK 21 或更高版本
- **内存**：至少 512MB 可用内存
- **硬盘空间**：至少 200MB 可用空间
- **网络**：稳定的网络连接
- **显示器**：最低分辨率 1024x768

### 推荐配置

- **操作系统**：Windows 10/11 / macOS 12+ / 最新Linux发行版
- **Java版本**：JDK 21 或更高版本
- **内存**：1GB 或更多可用内存
- **网络**：宽带连接
- **显示器**：1920x1080 或更高分辨率

---

## 安装和启动

### Windows系统

#### 1. 启动服务器

双击运行 `start-server.bat` 或在命令行执行：

```bash
java -jar xiangqi-server\target\xiangqi-server-1.0.0.jar
```

**服务器命令行选项：**

```bash
java -jar xiangqi-server.jar [选项]

可用选项：
  -p, --port <端口>           指定服务器端口（默认：8888）
  -c, --config <文件>         指定配置文件路径（默认：server.properties）
  -m, --max-connections <数量> 设置最大连接数（默认：100）
  -t, --threads <数量>        设置线程池大小（默认：20）
  -d, --debug                启用调试模式，输出详细日志
  --help                     显示帮助信息
```

**示例：**

```bash
# 使用自定义端口启动
java -jar xiangqi-server.jar -p 9999

# 使用自定义配置文件
java -jar xiangqi-server.jar -c my-server.properties

# 启用调试模式
java -jar xiangqi-server.jar -d
```

#### 2. 启动客户端

双击运行 `start-client.bat` 或在命令行执行：

```bash
java -jar xiangqi-client\target\xiangqi-client-1.0.0.jar
```

**客户端命令行选项：**

```bash
java -jar xiangqi-client.jar [选项]

可用选项：
  -h, --host <主机>       指定服务器地址（默认：localhost）
  -p, --port <端口>       指定服务器端口（默认：8888）
  -r, --resources <路径>  指定资源文件路径（默认：source）
  -d, --debug            启用调试模式
  --help                 显示帮助信息
```

**示例：**

```bash
# 连接到远程服务器
java -jar xiangqi-client.jar -h 192.168.1.100 -p 8888

# 使用自定义资源路径
java -jar xiangqi-client.jar -r /path/to/resources

# 启用调试模式
java -jar xiangqi-client.jar -d
```

---

## 界面介绍

### 登录界面

启动客户端后首先看到的是登录界面：

**界面元素：**
- **用户名输入框**：输入您的用户名（3-20个字符）
- **服务器地址**：显示当前连接的服务器地址和端口
- **登录按钮**：点击连接到服务器
- **设置按钮**：打开设置对话框

**登录步骤：**
1. 在用户名输入框中输入您的昵称
2. 确认服务器地址正确（默认为localhost:8888）
3. 点击"登录"按钮
4. 等待连接成功，进入游戏大厅

**注意事项：**
- 用户名不能重复，如果已被占用会提示重新输入
- 用户名仅支持中文、英文、数字和下划线
- 首次登录会自动创建账号

### 游戏大厅

登录成功后进入游戏大厅，这是游戏的中心枢纽：

**界面布局：**

```
┌─────────────────────────────────────────────┐
│ 游戏大厅                    [最小化] [关闭] │
├─────────────────────────────────────────────┤
│                                             │
│  在线玩家列表         │    游戏房间列表      │
│  ┌─────────────┐     │   ┌──────────────┐  │
│  │ 玩家1 [在线] │     │   │ 房间1 [2/2]  │  │
│  │ 玩家2 [游戏中]│    │   │ 房间2 [1/2]  │  │
│  │ 玩家3 [在线] │     │   │              │  │
│  └─────────────┘     │   └──────────────┘  │
│                      │                     │
│  [邀请对战] [创建房间]│   [加入] [观战]     │
│                                             │
│  系统消息：欢迎来到象棋游戏！                │
└─────────────────────────────────────────────┘
```

**功能说明：**

1. **在线玩家列表**
   - 显示所有在线玩家及其状态
   - 玩家状态：在线（绿色）、游戏中（黄色）、离开（灰色）
   - 双击玩家名可快速发起邀请

2. **游戏房间列表**
   - 显示当前所有游戏房间
   - 房间状态：等待中、进行中、已结束
   - 可以加入未满的房间或观战正在进行的游戏

3. **功能按钮**
   - **邀请对战**：选中一个在线玩家后，点击发起对战邀请
   - **创建房间**：创建一个新的游戏房间，等待其他玩家加入
   - **加入房间**：加入已有的房间开始游戏
   - **观战**：观看正在进行的游戏

### 游戏界面

进入游戏后的主要对弈界面：

```
┌──────────────────────────────────────────────────────────────────┐
│ 游戏对弈 - 红方 VS 黑方              [最小化] [退出]           │
├──────────────────────────────────────────────────────────────────┤
│ 红方: 玩家1  ⏱ 15:00     │  黑方: 玩家2  ⏱ 14:35           │
├──────────────────────────────────────────────────────────────────┤
│                           │   走棋记录                           │
│                           │  ┌─────────────────┐               │
│        象棋棋盘            │  │ 1. 炮二平五      │               │
│                           │  │ 2. 马8进7       │               │
│    [红方在下方]            │  │ 3. 马二进三      │               │
│    [黑方在上方]            │  │ 4. 车9平8       │               │
│                           │  │ ...             │               │
│    [棋盘图示]              │  └─────────────────┘               │
│                           │                                     │
│                           │  [认输] [求和] [悔棋]               │
├──────────────────────────────────────────────────────────────────┤
│ 聊天框：[________________]  [发送]                              │
│ 玩家1: 请多指教！                                                │
└──────────────────────────────────────────────────────────────────┘
```

**界面元素说明：**

1. **玩家信息栏**
   - 显示双方玩家名称
   - 显示剩余思考时间
   - 显示当前轮到谁走棋（高亮显示）

2. **棋盘区域**
   - 10x9的象棋棋盘
   - 红方在下，黑方在上
   - 可用鼠标点击或拖拽棋子

3. **走棋记录面板**
   - 按顺序显示所有走棋
   - 可以回看之前的棋局
   - 支持导出棋谱

4. **功能按钮**
   - **认输**：主动认输结束游戏
   - **求和**：向对方提出和棋请求
   - **悔棋**：请求悔一步棋（需对方同意）

5. **聊天区域**
   - 与对手实时交流
   - 支持发送表情（如果已实现）
   - 聊天记录自动保存

---

## 游戏操作

### 基本操作方法

#### 方法1：点击移动

1. 点击您要移动的棋子（棋子会高亮显示）
2. 该棋子的所有合法移动位置会用标记显示
3. 点击目标位置完成移动
4. 点击空白处或再次点击棋子可取消选择

#### 方法2：拖拽移动

1. 按住鼠标左键拖动棋子
2. 移动到目标位置
3. 松开鼠标完成移动
4. 如果移动不合法，棋子会自动返回原位

### 游戏流程

1. **开局阶段**
   - 红方先行
   - 建议先出马、炮控制中路
   - 注意保护中心兵和炮的位置

2. **中盘阶段**
   - 协调各子配合进攻
   - 注意将军和反将军
   - 保持子力平衡

3. **残局阶段**
   - 利用子力优势
   - 注意将帅对面
   - 寻找杀棋机会

### 特殊操作

#### 认输

当您认为局势不利时：
1. 点击"认输"按钮
2. 确认对话框点击"确定"
3. 游戏结束，对方获胜

#### 求和

如果双方势均力敌：
1. 点击"求和"按钮
2. 等待对方响应
3. 对方同意则和棋，拒绝则继续对局

#### 悔棋

如果走错了棋：
1. 点击"悔棋"按钮
2. 等待对方同意
3. 对方同意后悔一步棋
4. 注意：每局悔棋次数可能有限制

---

## 象棋规则

### 棋盘和棋子

**棋盘：**
- 9条竖线（路）× 10条横线
- 中间为"楚河汉界"
- 双方各有一个"九宫"（将帅活动区域）

**棋子：**
- 红方：帅、仕、相、马、车、炮、兵（各有规定数量）
- 黑方：将、士、象、马、车、炮、卒（各有规定数量）

### 各子走法

#### 将/帅（King）

- **活动范围**：只能在九宫内移动
- **走法**：每次走一格，横走或竖走
- **特殊规则**：不能和对方将帅面对面（中间无子）
- **示例**：帅五进一、帅五平四

#### 士（Advisor）

- **活动范围**：只能在九宫内移动
- **走法**：每次沿斜线走一格
- **特殊规则**：只有5个固定位置可站立
- **示例**：仕四进五、仕五退四

#### 象/相（Elephant）

- **活动范围**：不能过河
- **走法**：每次沿斜线走两格（田字格）
- **特殊规则**：路径中心有子时不能移动（俗称"塞象眼"）
- **示例**：相三进五、相七退五

#### 马（Horse）

- **活动范围**：全棋盘
- **走法**：走"日"字形（先横一格/竖一格，再斜一格）
- **特殊规则**：起点紧邻方向有子时不能走（俗称"蹩马腿"）
- **示例**：马二进三、马八进七

#### 车（Chariot/Rook）

- **活动范围**：全棋盘
- **走法**：直线移动，距离不限
- **特殊规则**：路径不能有子阻挡
- **示例**：车一平二、车九进一

#### 炮（Cannon）

- **活动范围**：全棋盘
- **走法**：直线移动，距离不限
- **特殊规则**：吃子时必须跳过一个棋子（炮架）
- **移动**：和车一样，路径不能有子
- **吃子**：必须跳过恰好一个棋子
- **示例**：炮二平五、炮五进四

#### 兵/卒（Pawn）

- **过河前**：只能向前走一格
- **过河后**：可以向前、向左、向右走一格，不能后退
- **特殊规则**：不能回退
- **示例**：兵三进一、卒7进1

### 胜负判定

#### 获胜条件

1. **将死对方**：对方的将/帅被将军且无法解救
2. **困毙对方**：对方无子可走（虽未被将军）
3. **对方认输**：对方主动认输
4. **对方超时**：对方思考时间用完

#### 和棋条件

1. **双方同意和棋**：通过求和按钮达成一致
2. **长打不变**：双方重复走同样的棋导致循环
3. **自然和局**：双方子力不足无法取胜

#### 判负条件

1. **一方认输**
2. **一方超时**
3. **违规操作**
4. **连接断开**（可设置判负或和棋）

### 特殊规则

#### 将军（Check）

- 下一步可以吃掉对方将/帅的状态
- 被将军方必须应将（解除将军状态）
- 应将方法：躲避、阻挡、反击将军方

#### 长将（Perpetual Check）

- 连续不停地将军
- 如果连续将军导致循环，判长将方负

#### 一将一杀

- 一方长将，一方长杀
- 双方都需要变招，否则和棋

---

## 高级功能

### 保存和加载棋局

#### 保存当前棋局

1. 在游戏中点击菜单"文件"→"保存棋局"
2. 选择保存位置和文件名
3. 棋局保存为 `.pgn` 或 `.xqf` 格式

#### 加载已保存棋局

1. 点击菜单"文件"→"打开棋局"
2. 选择要加载的棋局文件
3. 棋局会恢复到保存时的状态

### 棋谱导出

#### 导出为文本格式

1. 游戏结束后点击"导出棋谱"
2. 选择格式：PGN、XQF或TXT
3. 保存到本地文件

#### 分享棋谱

1. 导出棋谱后可以分享给朋友
2. 朋友可以导入棋谱研究棋局

### 观战模式

#### 观看他人对局

1. 在游戏大厅选择一个进行中的游戏
2. 点击"观战"按钮
3. 可以看到双方走棋，但不能参与

#### 观战功能

- 实时查看双方走棋
- 查看走棋记录
- 无法与棋手交流（避免干扰）

### 自定义设置

#### 界面设置

在设置中可以调整：
- 棋盘主题（木纹、大理石等）
- 棋子样式（传统、简约等）
- 界面语言
- 窗口大小

#### 音效设置

- 开启/关闭音效
- 调整音量大小
- 分别控制各类音效：
  - 移动棋子音效
  - 吃子音效
  - 将军提示音
  - 游戏结束音效

#### 游戏设置

- 显示合法移动提示
- 开启走棋确认
- 设置自动保存
- 显示坐标标记

---

## 故障排除

### 常见问题解答

#### 问题1：无法连接到服务器

**症状：** 点击登录后显示"连接失败"或"连接超时"

**可能原因和解决方案：**

1. **服务器未启动**
   - 确认服务器程序正在运行
   - 检查服务器窗口是否显示"服务器启动成功"

2. **地址或端口错误**
   - 检查 `client.properties` 中的服务器地址
   - 确认端口号正确（默认8888）
   - 如果服务器在其他电脑，使用正确的IP地址

3. **防火墙阻止**
   - 临时关闭防火墙测试
   - 或在防火墙中添加程序例外
   - 确保端口8888未被阻止

4. **网络问题**
   - 检查网络连接是否正常
   - 尝试ping服务器地址
   - 确认在同一局域网内（如果是本地联机）

#### 问题2：游戏卡顿或延迟

**症状：** 走棋后对方延迟收到，界面反应慢

**解决方案：**

1. **检查网络质量**
   - 关闭占用带宽的其他程序（下载、视频等）
   - 使用有线网络代替WiFi
   - 检查网络延迟（ping值）

2. **降低画质**
   - 在设置中关闭动画效果
   - 使用简约棋子样式
   - 减小窗口大小

3. **系统资源**
   - 关闭其他占用内存的程序
   - 检查CPU使用率
   - 确保有足够的可用内存

4. **重新连接**
   - 退出游戏重新登录
   - 重启客户端程序
   - 重启路由器

#### 问题3：音效无法播放

**症状：** 移动棋子或吃子时没有声音

**解决方案：**

1. **检查音效设置**
   - 确认 `client.properties` 中 `audio.enabled=true`
   - 检查游戏内音效开关
   - 调整音量滑块

2. **检查音频文件**
   - 确认 `source/audio/` 目录存在
   - 检查音效文件是否完整
   - 确保文件格式为 .wav

3. **系统音频**
   - 检查系统音量是否静音
   - 确认音频设备正常工作
   - 测试播放其他音频文件

4. **驱动问题**
   - 更新声卡驱动程序
   - 检查音频服务是否启动

#### 问题4：棋子无法移动

**症状：** 点击棋子后无法选中或移动

**可能原因：**

1. **不是您的回合**
   - 检查是否轮到您走棋
   - 查看界面上的回合提示

2. **棋子选择错误**
   - 确认选择的是己方棋子
   - 红方只能移动红色棋子

3. **移动不合法**
   - 目标位置不在合法移动范围内
   - 受到将军必须先应将
   - 移动后会导致己方被将军

4. **界面冻结**
   - 尝试点击其他棋子
   - 重新选择棋子
   - 必要时重启客户端

#### 问题5：界面显示异常

**症状：** 棋盘错位、棋子不显示、界面乱码

**解决方案：**

1. **分辨率问题**
   - 调整显示器分辨率至少1024x768
   - 修改 `client.properties` 中的窗口大小
   - 使用系统推荐的显示缩放

2. **资源文件问题**
   - 确认 `source` 目录完整
   - 检查图片文件是否损坏
   - 重新下载资源文件

3. **Java版本**
   - 确认使用JDK 21或更高版本
   - 更新Java到最新版本

4. **显卡驱动**
   - 更新显卡驱动程序
   - 检查硬件加速设置

#### 问题6：游戏突然断开连接

**症状：** 游戏进行中突然掉线

**可能原因：**

1. **网络中断**
   - 检查网络连接
   - 查看路由器状态
   - 测试网络稳定性

2. **服务器问题**
   - 服务器可能崩溃或重启
   - 联系服务器管理员

3. **超时**
   - 长时间无操作导致超时
   - 调整 `server.properties` 中的超时设置

4. **客户端崩溃**
   - 查看客户端错误日志
   - 重启客户端程序

#### 问题7：无法发送聊天消息

**症状：** 聊天框输入后无法发送

**解决方案：**

1. 确认聊天功能已开启
2. 检查消息长度（可能有字数限制）
3. 检查是否包含非法字符
4. 重新连接服务器

#### 问题8：棋谱无法保存或加载

**症状：** 点击保存后失败，或加载棋谱出错

**解决方案：**

1. **权限问题**
   - 确保有文件写入权限
   - 尝试保存到其他目录
   - 以管理员身份运行

2. **文件格式**
   - 确认使用正确的文件格式（.pgn/.xqf）
   - 检查文件是否损坏
   - 使用文本编辑器查看文件内容

3. **路径问题**
   - 避免使用特殊字符
   - 使用英文路径
   - 确保路径存在

### 性能优化建议

#### 提升游戏流畅度

1. **关闭不必要的功能**
   ```properties
   # 在 client.properties 中
   ui.enableAnimations=false
   audio.enabled=false
   ```

2. **减少资源缓存**
   ```properties
   resources.cacheSize=20
   ```

3. **调整JVM参数**
   ```bash
   java -Xms256m -Xmx512m -jar xiangqi-client.jar
   ```

#### 降低网络延迟

1. **使用有线连接**
2. **选择地理位置近的服务器**
3. **优化路由器设置**

### 日志和调试

#### 查看日志文件

**客户端日志：**
- 位置：控制台输出或指定的日志文件
- 启用详细日志：使用 `-d` 参数启动

**服务器日志：**
- 位置：`xiangqi-server.log`（如果配置了）
- 查看实时日志：观察服务器控制台输出

#### 报告问题

如果遇到无法解决的问题：

1. **收集信息**
   - 问题发生的时间
   - 详细的错误描述
   - 错误日志内容
   - 系统环境信息

2. **提交Issue**
   - 在项目仓库提交Issue
   - 附上日志文件
   - 说明重现步骤

---

## 附录

### 快捷键列表（如果已实现）

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + N` | 新建游戏 |
| `Ctrl + S` | 保存棋局 |
| `Ctrl + O` | 打开棋局 |
| `Ctrl + Z` | 请求悔棋 |
| `Ctrl + Q` | 退出游戏 |
| `F1` | 帮助文档 |
| `Esc` | 取消选择 |

### 术语表

- **将军（Check）**：攻击对方的将/帅
- **将死（Checkmate）**：对方无法解除将军状态
- **困毙（Stalemate）**：无子可走但未被将军
- **长将（Perpetual Check）**：连续不停地将军
- **和棋（Draw）**：双方平局
- **九宫**：将帅活动的3x3区域
- **楚河汉界**：棋盘中间的分界线

### 联系和支持

- **项目文档**：查看其他Markdown文档
- **配置帮助**：参考 [CONFIG_README.md](CONFIG_README.md)
- **开发文档**：参考 [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md)
- **快速开始**：参考 [QUICK_START.md](QUICK_START.md)

---

**祝您对弈愉快！享受象棋的乐趣！** 🎉