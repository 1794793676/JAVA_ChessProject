# è±¡æ£‹æ¸¸æˆå¼€å‘è€…æ–‡æ¡£

æœ¬æ–‡æ¡£é¢å‘å¸Œæœ›äº†è§£é¡¹ç›®æ¶æ„ã€å‚ä¸å¼€å‘æˆ–æ‰©å±•åŠŸèƒ½çš„å¼€å‘è€…ã€‚å†…å®¹æ¶µç›–é¡¹ç›®ç»“æ„ã€æ ¸å¿ƒç»„ä»¶ã€å¼€å‘è§„èŒƒã€æµ‹è¯•ç­–ç•¥ç­‰æ–¹æ–¹é¢é¢ã€‚

## ğŸ“‘ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [å¼€å‘ç¯å¢ƒé…ç½®](#å¼€å‘ç¯å¢ƒé…ç½®)
- [é¡¹ç›®ç»“æ„è¯¦è§£](#é¡¹ç›®ç»“æ„è¯¦è§£)
- [æ ¸å¿ƒç»„ä»¶è¯´æ˜](#æ ¸å¿ƒç»„ä»¶è¯´æ˜)
- [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
- [æµ‹è¯•ç­–ç•¥](#æµ‹è¯•ç­–ç•¥)
- [ç½‘ç»œåè®®](#ç½‘ç»œåè®®)
- [æ‰©å±•å¼€å‘](#æ‰©å±•å¼€å‘)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [è°ƒè¯•æŠ€å·§](#è°ƒè¯•æŠ€å·§)

---

## é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºJava Swingçš„ç½‘ç»œè±¡æ£‹æ¸¸æˆé¡¹ç›®ï¼Œé‡‡ç”¨ç»å…¸çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨ï¼ˆC/Sï¼‰æ¶æ„ã€‚é¡¹ç›®ä½¿ç”¨Mavenè¿›è¡Œæ„å»ºç®¡ç†ï¼Œæ”¯æŒå¤šäººåœ¨çº¿å¯¹æˆ˜å’Œå®Œæ•´çš„è±¡æ£‹æ¸¸æˆé€»è¾‘ã€‚

### è®¾è®¡ç›®æ ‡

- **æ¨¡å—åŒ–è®¾è®¡**ï¼šå°†å…±äº«ã€å®¢æˆ·ç«¯ã€æœåŠ¡å™¨åˆ†ç¦»ä¸ºç‹¬ç«‹æ¨¡å—
- **å¯æ‰©å±•æ€§**ï¼šæ˜“äºæ·»åŠ æ–°åŠŸèƒ½å’Œæ£‹å­ç±»å‹
- **é«˜æ€§èƒ½**ï¼šæ”¯æŒå¤šäººåŒæ—¶åœ¨çº¿å¯¹æˆ˜
- **å¯æµ‹è¯•æ€§**ï¼šå®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•è¦†ç›–
- **æ˜“ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„å’Œæ–‡æ¡£

### å…³é”®ç‰¹æ€§

- âœ… å®Œæ•´çš„ä¸­å›½è±¡æ£‹è§„åˆ™å®ç°
- âœ… åŸºäºSocketçš„ç½‘ç»œé€šä¿¡
- âœ… å¤šçº¿ç¨‹æ”¯æŒå¹¶å‘è¿æ¥
- âœ… äº‹ä»¶é©±åŠ¨çš„æ¶æ„è®¾è®¡
- âœ… èµ„æºç®¡ç†å’Œç¼“å­˜æœºåˆ¶
- âœ… å¯é…ç½®çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å‚æ•°

---

## æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·å±‚                               â”‚
â”‚              [å®¢æˆ·ç«¯1] [å®¢æˆ·ç«¯2] ... [å®¢æˆ·ç«¯N]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                   â”‚
              â”‚  ç½‘ç»œé€šä¿¡ (Socket + è‡ªå®šä¹‰åè®®)    â”‚
              â”‚                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æœåŠ¡å™¨å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è¿æ¥ç®¡ç†å™¨   â”‚  â”‚  æ¸¸æˆä¼šè¯     â”‚  â”‚  æ¶ˆæ¯è·¯ç”±å™¨     â”‚   â”‚
â”‚  â”‚             â”‚  â”‚  ç®¡ç†å™¨       â”‚  â”‚                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ ä½¿ç”¨å…±äº«æ¨¡å—
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å…±äº«å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æ•°æ®æ¨¡å‹  â”‚  â”‚ æ¸¸æˆå¼•æ“   â”‚  â”‚ ç½‘ç»œæ¶ˆæ¯   â”‚  â”‚ å·¥å…·ç±» â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—ä¾èµ–å…³ç³»

```
xiangqi-client â”€â”€â”€â”€ä¾èµ–â”€â”€â”€â”€> xiangqi-shared
                            â–²
xiangqi-server â”€â”€â”€â”€ä¾èµ–â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆè¯¦æƒ…

| å±‚æ¬¡ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **ç¼–ç¨‹è¯­è¨€** | Java 21 | ä½¿ç”¨æœ€æ–°LTSç‰ˆæœ¬ |
| **æ„å»ºå·¥å…·** | Maven 3.x | å¤šæ¨¡å—é¡¹ç›®ç®¡ç† |
| **UIæ¡†æ¶** | Swing | è·¨å¹³å°GUIæ¡†æ¶ |
| **ç½‘ç»œé€šä¿¡** | Socket + ObjectStream | è‡ªå®šä¹‰åè®® |
| **å¹¶å‘å¤„ç†** | ExecutorService | çº¿ç¨‹æ± ç®¡ç† |
| **æµ‹è¯•æ¡†æ¶** | JUnit 5 | å•å…ƒæµ‹è¯• |
| **å±æ€§æµ‹è¯•** | QuickCheck | å±æ€§é©±åŠ¨æµ‹è¯• |
| **åºåˆ—åŒ–** | Java Serialization | å¯¹è±¡ä¼ è¾“ |

---

## å¼€å‘ç¯å¢ƒé…ç½®

### å¿…éœ€å·¥å…·

| å·¥å…· | æœ€ä½ç‰ˆæœ¬ | æ¨èç‰ˆæœ¬ | ç”¨é€” |
|------|----------|----------|------|
| **JDK** | 21 | 21+ | Javaå¼€å‘ç¯å¢ƒ |
| **Maven** | 3.6 | 3.9+ | é¡¹ç›®æ„å»ºå·¥å…· |
| **IDE** | - | IntelliJ IDEA / Eclipse | ä»£ç ç¼–è¾‘ |
| **Git** | 2.x | æœ€æ–°ç‰ˆ | ç‰ˆæœ¬æ§åˆ¶ |

### IDEé…ç½®

#### IntelliJ IDEAï¼ˆæ¨èï¼‰

1. **å¯¼å…¥é¡¹ç›®**
   ```
   File â†’ Open â†’ é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•çš„pom.xml
   ```

2. **é…ç½®JDK**
   ```
   File â†’ Project Structure â†’ Project
   SDK: é€‰æ‹© JDK 21
   Language Level: 21
   ```

3. **é…ç½®Maven**
   ```
   File â†’ Settings â†’ Build, Execution, Deployment â†’ Build Tools â†’ Maven
   Maven home directory: æŒ‡å‘Mavenå®‰è£…ç›®å½•
   User settings file: æŒ‡å‘settings.xml
   ```

4. **å¯ç”¨æ³¨è§£å¤„ç†**
   ```
   File â†’ Settings â†’ Build, Execution, Deployment â†’ Compiler â†’ Annotation Processors
   å‹¾é€‰"Enable annotation processing"
   ```

5. **ä»£ç é£æ ¼**
   ```
   File â†’ Settings â†’ Editor â†’ Code Style â†’ Java
   å¯¼å…¥é¡¹ç›®æä¾›çš„ä»£ç é£æ ¼é…ç½®æ–‡ä»¶(å¦‚æœæœ‰)
   ```

#### Eclipseé…ç½®

1. **å¯¼å…¥Mavené¡¹ç›®**
   ```
   File â†’ Import â†’ Maven â†’ Existing Maven Projects
   ```

2. **è®¾ç½®JDK**
   ```
   Window â†’ Preferences â†’ Java â†’ Installed JREs
   æ·»åŠ JDK 21
   ```

3. **Mavenè®¾ç½®**
   ```
   Window â†’ Preferences â†’ Maven
   é…ç½®Maven installationå’ŒUser Settings
   ```

### é¡¹ç›®å…‹éš†å’Œæ„å»º

```bash
# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœä½¿ç”¨Gitï¼‰
git clone <repository-url>
cd JAVA_ChessProject

# ç¼–è¯‘æ‰€æœ‰æ¨¡å—
mvn clean compile

# è¿è¡Œæµ‹è¯•
mvn test

# æ‰“åŒ…é¡¹ç›®ï¼ˆç”ŸæˆJARæ–‡ä»¶ï¼‰
mvn package

# å®‰è£…åˆ°æœ¬åœ°Mavenä»“åº“
mvn install

# è·³è¿‡æµ‹è¯•å¿«é€Ÿæ„å»º
mvn clean package -DskipTests
```

### å¸¸ç”¨Mavenå‘½ä»¤

```bash
# æ¸…ç†æ„å»ºäº§ç‰©
mvn clean

# ä»…ç¼–è¯‘æºä»£ç 
mvn compile

# ç¼–è¯‘æµ‹è¯•ä»£ç 
mvn test-compile

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
mvn test

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
mvn test -Dtest=ChessEngineTest

# è¿è¡Œç‰¹å®šæ¨¡å—çš„æµ‹è¯•
mvn test -pl xiangqi-shared

# æŸ¥çœ‹ä¾èµ–æ ‘
mvn dependency:tree

# æ›´æ–°ä¾èµ–
mvn clean install -U

# ç”Ÿæˆé¡¹ç›®ç«™ç‚¹
mvn site
```

---

## é¡¹ç›®ç»“æ„è¯¦è§£

### ç›®å½•ç»“æ„è¯´æ˜

```
JAVA_ChessProject/
â”œâ”€â”€ pom.xml                     # çˆ¶POMï¼Œå®šä¹‰å…¨å±€é…ç½®å’Œä¾èµ–ç®¡ç†
â”œâ”€â”€ build.bat                   # Windowsæ„å»ºè„šæœ¬
â”œâ”€â”€ start-server.bat            # æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ start-client.bat            # å®¢æˆ·ç«¯å¯åŠ¨è„šæœ¬
â”œâ”€â”€ server.properties           # æœåŠ¡å™¨é…ç½®
â”œâ”€â”€ client.properties           # å®¢æˆ·ç«¯é…ç½®
â”œâ”€â”€ docs/                       # é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ *.md                    # å„ç±»æ–‡æ¡£
â”‚
â”œâ”€â”€ xiangqi-shared/             # å…±äº«æ¨¡å— - è¢«å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¾èµ–
â”‚   â”œâ”€â”€ pom.xml                 # æ¨¡å—POMé…ç½®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â””â”€â”€ java/com/xiangqi/shared/
â”‚   â”‚   â”‚       â”œâ”€â”€ model/      # æ•°æ®æ¨¡å‹åŒ…
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Player.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Position.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ChessPiece.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Move.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ GameState.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ GameResult.java
â”‚   â”‚   â”‚       â”‚
â”‚   â”‚   â”‚       â”œâ”€â”€ network/    # ç½‘ç»œé€šä¿¡åŒ…
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ NetworkMessage.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ MessageType.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ LoginMessage.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ MoveMessage.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚       â”‚
â”‚   â”‚   â”‚       â””â”€â”€ engine/     # æ¸¸æˆå¼•æ“åŒ…
â”‚   â”‚   â”‚           â”œâ”€â”€ ChessEngine.java
â”‚   â”‚   â”‚           â”œâ”€â”€ RuleValidator.java
â”‚   â”‚   â”‚           â””â”€â”€ GameEventListener.java
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ test/               # å•å…ƒæµ‹è¯•
â”‚   â”‚       â””â”€â”€ java/com/xiangqi/shared/
â”‚   â”‚
â”‚   â””â”€â”€ target/                 # Mavenæ„å»ºè¾“å‡ºç›®å½•
â”‚
â”œâ”€â”€ xiangqi-server/             # æœåŠ¡å™¨æ¨¡å—
â”‚   â”œâ”€â”€ pom.xml
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â””â”€â”€ java/com/xiangqi/server/
â”‚   â”‚   â”‚       â”œâ”€â”€ ServerMain.java         # æœåŠ¡å™¨ä¸»å…¥å£
â”‚   â”‚   â”‚       â””â”€â”€ network/                # ç½‘ç»œæœåŠ¡åŒ…
â”‚   â”‚   â”‚           â”œâ”€â”€ GameServer.java     # æ ¸å¿ƒæœåŠ¡å™¨ç±»
â”‚   â”‚   â”‚           â”œâ”€â”€ ClientHandler.java  # å®¢æˆ·ç«¯è¿æ¥å¤„ç†
â”‚   â”‚   â”‚           â””â”€â”€ GameSession.java    # æ¸¸æˆä¼šè¯ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ test/               # å•å…ƒæµ‹è¯•
â”‚   â”‚
â”‚   â””â”€â”€ target/                 # æ„å»ºè¾“å‡º
â”‚
â”œâ”€â”€ xiangqi-client/             # å®¢æˆ·ç«¯æ¨¡å—
â”‚   â”œâ”€â”€ pom.xml
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â””â”€â”€ java/com/xiangqi/client/
â”‚   â”‚   â”‚       â”œâ”€â”€ ClientMain.java         # å®¢æˆ·ç«¯ä¸»å…¥å£
â”‚   â”‚   â”‚       â”‚
â”‚   â”‚   â”‚       â”œâ”€â”€ ui/                     # ç”¨æˆ·ç•Œé¢åŒ…
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ LoginFrame.java     # ç™»å½•ç•Œé¢
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ LobbyFrame.java     # æ¸¸æˆå¤§å…
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ GameFrame.java      # æ¸¸æˆä¸»ç•Œé¢
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ChessBoardPanel.java # æ£‹ç›˜é¢æ¿
â”‚   â”‚   â”‚       â”‚
â”‚   â”‚   â”‚       â”œâ”€â”€ network/                # ç½‘ç»œå®¢æˆ·ç«¯åŒ…
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ NetworkClient.java  # ç½‘ç»œé€šä¿¡å®¢æˆ·ç«¯
â”‚   â”‚   â”‚       â”‚
â”‚   â”‚   â”‚       â””â”€â”€ multimedia/             # å¤šåª’ä½“åŒ…
â”‚   â”‚   â”‚           â”œâ”€â”€ AudioManager.java   # éŸ³é¢‘ç®¡ç†
â”‚   â”‚   â”‚           â””â”€â”€ ResourceManager.java # èµ„æºç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ test/               # å•å…ƒæµ‹è¯•
â”‚   â”‚
â”‚   â””â”€â”€ target/                 # æ„å»ºè¾“å‡º
â”‚
â””â”€â”€ source/                     # æ¸¸æˆèµ„æºæ–‡ä»¶
    â”œâ”€â”€ audio/                  # éŸ³æ•ˆæ–‡ä»¶ (.wav)
    â”‚   â”œâ”€â”€ move.wav
    â”‚   â”œâ”€â”€ capture.wav
    â”‚   â”œâ”€â”€ check.wav
    â”‚   â””â”€â”€ ...
    â”‚
    â”œâ”€â”€ face/                   # ç©å®¶å¤´åƒ (.gif)
    â”‚   â””â”€â”€ *.gif
    â”‚
    â”œâ”€â”€ img/                    # UIå›¾ç‰‡ (.gif)
    â”‚   â””â”€â”€ *.gif
    â”‚
    â””â”€â”€ qizi/                   # æ£‹å­å›¾ç‰‡ (.gif)
        â”œâ”€â”€ r_jiang.gif         # çº¢æ–¹å°†
        â”œâ”€â”€ r_che.gif           # çº¢æ–¹è½¦
        â”œâ”€â”€ b_jiang.gif         # é»‘æ–¹å°†
        â””â”€â”€ ...
```

### åŒ…å‘½åè§„èŒƒ

- `com.xiangqi.shared.model` - æ•°æ®æ¨¡å‹ç±»
- `com.xiangqi.shared.network` - ç½‘ç»œæ¶ˆæ¯ç±»
- `com.xiangqi.shared.engine` - æ¸¸æˆå¼•æ“å’Œè§„åˆ™
- `com.xiangqi.server.network` - æœåŠ¡å™¨ç½‘ç»œå±‚
- `com.xiangqi.client.ui` - å®¢æˆ·ç«¯ç•Œé¢
- `com.xiangqi.client.network` - å®¢æˆ·ç«¯ç½‘ç»œå±‚
- `com.xiangqi.client.multimedia` - å®¢æˆ·ç«¯å¤šåª’ä½“

---

## æ ¸å¿ƒç»„ä»¶è¯´æ˜

### å…±äº«æ¨¡å— (xiangqi-shared)

#### 1. æ•°æ®æ¨¡å‹ (modelåŒ…)

**Player.java - ç©å®¶ç±»**

```java
public class Player implements Serializable {
    private String id;              // å”¯ä¸€æ ‡è¯†
    private String username;        // ç”¨æˆ·å
    private PlayerStatus status;    // ç©å®¶çŠ¶æ€
    private int rating;            // ç­‰çº§åˆ†
    private PlayerStatistics stats; // ç»Ÿè®¡æ•°æ®
    
    // æ„é€ æ–¹æ³•ã€getter/setterã€ä¸šåŠ¡æ–¹æ³•
}
```

**Position.java - ä½ç½®ç±»**

```java
public class Position implements Serializable {
    private int row;    // è¡Œ (0-9)
    private int col;    // åˆ— (0-8)
    
    // éªŒè¯ä½ç½®æ˜¯å¦åˆæ³•ï¼ˆ10x9æ£‹ç›˜ï¼‰
    public boolean isValid() {
        return row >= 0 && row < 10 && col >= 0 && col < 9;
    }
}
```

**ChessPiece.java - æ£‹å­æŠ½è±¡ç±»**

```java
public abstract class ChessPiece implements Serializable {
    protected PieceType type;      // æ£‹å­ç±»å‹
    protected Side side;           // çº¢æ–¹/é»‘æ–¹
    protected Position position;   // å½“å‰ä½ç½®
    
    // æŠ½è±¡æ–¹æ³•ï¼šè·å–æ‰€æœ‰åˆæ³•ç§»åŠ¨
    public abstract List<Position> getValidMoves(GameState state);
    
    // æŠ½è±¡æ–¹æ³•ï¼šéªŒè¯ç§»åŠ¨æ˜¯å¦åˆæ³•
    public abstract boolean isValidMove(Position target, GameState state);
}
```

**GameState.java - æ¸¸æˆçŠ¶æ€ç±»**

```java
public class GameState implements Serializable {
    private ChessPiece[][] board;   // æ£‹ç›˜ [10][9]
    private Side currentPlayer;     // å½“å‰ç©å®¶
    private GameStatus status;      // æ¸¸æˆçŠ¶æ€
    private List<Move> moveHistory; // ç§»åŠ¨å†å²
    private Player redPlayer;       // çº¢æ–¹ç©å®¶
    private Player blackPlayer;     // é»‘æ–¹ç©å®¶
    
    // æ·±åº¦æ‹·è´ï¼Œç”¨äºæ¨¡æ‹Ÿç§»åŠ¨
    public GameState deepCopy();
    
    // æ‰§è¡Œç§»åŠ¨
    public void executeMove(Move move);
    
    // æ’¤é”€ç§»åŠ¨
    public void undoMove();
}
```

#### 2. ç½‘ç»œé€šä¿¡ (networkåŒ…)

**NetworkMessage.java - æ¶ˆæ¯åŸºç±»**

```java
public abstract class NetworkMessage implements Serializable {
    protected MessageType type;     // æ¶ˆæ¯ç±»å‹
    protected String senderId;      // å‘é€è€…ID
    protected long timestamp;       // æ—¶é—´æˆ³
    
    public abstract void process(NetworkMessageHandler handler);
}
```

**MessageTypeæšä¸¾ - æ¶ˆæ¯ç±»å‹**

```java
public enum MessageType {
    // è®¤è¯ç›¸å…³
    LOGIN_REQUEST,
    LOGIN_RESPONSE,
    LOGOUT,
    
    // æ¸¸æˆå¤§å…
    LOBBY_UPDATE,
    PLAYER_LIST,
    GAME_INVITATION,
    INVITATION_RESPONSE,
    
    // æ¸¸æˆå¯¹å¼ˆ
    MOVE_MESSAGE,
    MOVE_RESPONSE,
    GAME_START,
    GAME_END,
    
    // å…¶ä»–
    CHAT_MESSAGE,
    HEARTBEAT,
    ERROR_MESSAGE
}
```

#### 3. æ¸¸æˆå¼•æ“ (engineåŒ…)

**ChessEngine.java - æ¸¸æˆå¼•æ“**

```java
public class ChessEngine {
    private GameState gameState;
    private RuleValidator ruleValidator;
    private List<GameEventListener> listeners;
    
    // æ‰§è¡Œç§»åŠ¨
    public boolean makeMove(Move move) {
        if (ruleValidator.isValidMove(move, gameState)) {
            gameState.executeMove(move);
            notifyListeners(GameEvent.MOVE_MADE, move);
            
            // æ£€æŸ¥å°†å†›ã€å°†æ­»
            if (isCheck(gameState.getCurrentPlayer())) {
                if (isCheckmate(gameState.getCurrentPlayer())) {
                    gameState.setStatus(GameStatus.CHECKMATE);
                    notifyListeners(GameEvent.CHECKMATE, null);
                } else {
                    gameState.setStatus(GameStatus.CHECK);
                    notifyListeners(GameEvent.CHECK, null);
                }
            }
            return true;
        }
        return false;
    }
    
    // æ£€æŸ¥æ˜¯å¦å°†å†›
    public boolean isCheck(Side side);
    
    // æ£€æŸ¥æ˜¯å¦å°†æ­»
    public boolean isCheckmate(Side side);
}
```

### æœåŠ¡å™¨æ¨¡å— (xiangqi-server)

#### GameServer.java - æ ¸å¿ƒæœåŠ¡å™¨ç±»

```java
public class GameServer implements NetworkMessageHandler {
    private ServerSocket serverSocket;
    private ExecutorService threadPool;
    private Map<String, ClientHandler> clients;
    private Map<String, GameSession> gameSessions;
    private Properties config;
    
    // å¯åŠ¨æœåŠ¡å™¨
    public void start(int port) {
        serverSocket = new ServerSocket(port);
        threadPool = Executors.newFixedThreadPool(config.getThreadPoolSize());
        
        // ç›‘å¬å®¢æˆ·ç«¯è¿æ¥
        while (running) {
            Socket clientSocket = serverSocket.accept();
            ClientHandler handler = new ClientHandler(clientSocket, this);
            threadPool.execute(handler);
        }
    }
    
    // å¤„ç†å®¢æˆ·ç«¯æ¶ˆæ¯
    @Override
    public void handleMessage(NetworkMessage message, ClientHandler client) {
        switch (message.getType()) {
            case LOGIN_REQUEST:
                handleLogin((LoginMessage) message, client);
                break;
            case MOVE_MESSAGE:
                handleMove((MoveMessage) message, client);
                break;
            // ... å…¶ä»–æ¶ˆæ¯ç±»å‹
        }
    }
    
    // å¹¿æ’­æ¶ˆæ¯ç»™æ‰€æœ‰å®¢æˆ·ç«¯
    public void broadcast(NetworkMessage message);
    
    // å‘é€æ¶ˆæ¯ç»™ç‰¹å®šå®¢æˆ·ç«¯
    public void sendToClient(String clientId, NetworkMessage message);
}
```

#### ClientHandler.java - å®¢æˆ·ç«¯è¿æ¥å¤„ç†

```java
public class ClientHandler implements Runnable {
    private Socket socket;
    private ObjectOutputStream out;
    private ObjectInputStream in;
    private GameServer server;
    private Player player;
    private boolean connected;
    
    @Override
    public void run() {
        try {
            out = new ObjectOutputStream(socket.getOutputStream());
            in = new ObjectInputStream(socket.getInputStream());
            
            // æŒç»­æ¥æ”¶æ¶ˆæ¯
            while (connected) {
                NetworkMessage message = (NetworkMessage) in.readObject();
                server.handleMessage(message, this);
            }
        } catch (Exception e) {
            handleDisconnect();
        }
    }
    
    // å‘é€æ¶ˆæ¯
    public void sendMessage(NetworkMessage message) {
        synchronized (out) {
            out.writeObject(message);
            out.flush();
        }
    }
}
```

### å®¢æˆ·ç«¯æ¨¡å— (xiangqi-client)

#### NetworkClient.java - ç½‘ç»œå®¢æˆ·ç«¯

```java
public class NetworkClient {
    private Socket socket;
    private ObjectOutputStream out;
    private ObjectInputStream in;
    private MessageListener messageListener;
    private boolean connected;
    
    // è¿æ¥æœåŠ¡å™¨
    public boolean connect(String host, int port) {
        try {
            socket = new Socket(host, port);
            out = new ObjectOutputStream(socket.getOutputStream());
            in = new ObjectInputStream(socket.getInputStream());
            connected = true;
            
            // å¯åŠ¨æ¶ˆæ¯æ¥æ”¶çº¿ç¨‹
            new Thread(this::receiveMessages).start();
            return true;
        } catch (IOException e) {
            return false;
        }
    }
    
    // å‘é€æ¶ˆæ¯
    public void sendMessage(NetworkMessage message) {
        synchronized (out) {
            out.writeObject(message);
            out.flush();
        }
    }
    
    // æ¥æ”¶æ¶ˆæ¯çº¿ç¨‹
    private void receiveMessages() {
        while (connected) {
            NetworkMessage message = (NetworkMessage) in.readObject();
            messageListener.onMessageReceived(message);
        }
    }
}
```

#### UIç»„ä»¶

**LoginFrame, LobbyFrame, GameFrame** ç­‰Swingç»„ä»¶è´Ÿè´£ç”¨æˆ·ç•Œé¢å±•ç¤ºå’Œäº¤äº’ã€‚

**ResourceManager** ç®¡ç†å›¾ç‰‡èµ„æºç¼“å­˜ï¼Œ**AudioManager** å¤„ç†éŸ³æ•ˆæ’­æ”¾ã€‚

---

## ä»£ç è§„èŒƒ

### å‘½åè§„èŒƒ

| ç±»å‹ | è§„èŒƒ | ç¤ºä¾‹ |
|------|------|------|
| ç±»å | PascalCase | `GameEngine`, `ChessPiece` |
| æ¥å£ | PascalCase | `GameEventListener`, `NetworkMessageHandler` |
| æ–¹æ³• | camelCase | `makeMove()`, `isValidMove()` |
| å˜é‡ | camelCase | `gameState`, `currentPlayer` |
| å¸¸é‡ | UPPER_SNAKE_CASE | `MAX_PLAYERS`, `DEFAULT_PORT` |
| åŒ…å | å°å†™+ç‚¹åˆ†éš” | `com.xiangqi.shared.model` |

### æ³¨é‡Šè§„èŒƒ

```java
/**
 * è±¡æ£‹å¼•æ“ç±»ï¼Œè´Ÿè´£æ¸¸æˆé€»è¾‘å¤„ç†
 * Chess engine class responsible for game logic
 *
 * @author ä½œè€…å
 * @version 1.0.0
 * @since 2024-12-24
 */
public class ChessEngine {
    
    /**
     * æ‰§è¡Œä¸€æ­¥æ£‹
     * Execute a chess move
     *
     * @param move è¦æ‰§è¡Œçš„ç§»åŠ¨
     * @return æ˜¯å¦æˆåŠŸæ‰§è¡Œ
     * @throws IllegalArgumentException å¦‚æœç§»åŠ¨ä¸åˆæ³•
     */
    public boolean makeMove(Move move) {
        // å®ç°ä»£ç 
    }
}
```

### ä»£ç æ ¼å¼

- ä½¿ç”¨4ä¸ªç©ºæ ¼ç¼©è¿›ï¼ˆä¸ä½¿ç”¨Tabï¼‰
- è¡Œé•¿åº¦ä¸è¶…è¿‡120å­—ç¬¦
- å¤§æ‹¬å·é‡‡ç”¨K&Ré£æ ¼ï¼ˆå·¦å¤§æ‹¬å·ä¸æ¢è¡Œï¼‰
- æ–¹æ³•ä¹‹é—´ç©ºä¸€è¡Œ
- é€»è¾‘å—ä¹‹é—´ç©ºä¸€è¡Œ

---

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•ç¤ºä¾‹

```java
@Test
public void testPositionValidation() {
    // åˆæ³•ä½ç½®
    assertTrue(new Position(0, 0).isValid());
    assertTrue(new Position(9, 8).isValid());
    
    // éæ³•ä½ç½®
    assertFalse(new Position(-1, 0).isValid());
    assertFalse(new Position(10, 0).isValid());
    assertFalse(new Position(0, 9).isValid());
}
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
mvn test

# è¿è¡Œç‰¹å®šæ¨¡å—
mvn test -pl xiangqi-shared

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
mvn surefire-report:report
```

---

## ç½‘ç»œåè®®

### æ¶ˆæ¯æ ¼å¼

æ‰€æœ‰æ¶ˆæ¯ç»§æ‰¿è‡ª`NetworkMessage`ï¼Œé€šè¿‡Javaåºåˆ—åŒ–ä¼ è¾“ã€‚

### é€šä¿¡æµç¨‹

1. å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨
2. å‘é€`LOGIN_REQUEST`
3. æœåŠ¡å™¨éªŒè¯å¹¶è¿”å›`LOGIN_RESPONSE`
4. è¿›å…¥å¤§å…ï¼Œæ¥æ”¶`LOBBY_UPDATE`
5. æ¸¸æˆä¸­äº¤æ¢`MOVE_MESSAGE`
6. æ¸¸æˆç»“æŸå‘é€`GAME_END`æ¶ˆæ¯

---

## æ‰©å±•å¼€å‘

### æ·»åŠ æ–°æ£‹å­

1. ç»§æ‰¿`ChessPiece`ç±»
2. å®ç°`getValidMoves()`æ–¹æ³•
3. åœ¨`PieceFactory`ä¸­æ³¨å†Œ
4. æ·»åŠ å¯¹åº”å›¾ç‰‡èµ„æº

### æ·»åŠ æ–°æ¶ˆæ¯ç±»å‹

1. åœ¨`MessageType`æšä¸¾ä¸­æ·»åŠ ç±»å‹
2. åˆ›å»ºæ–°çš„æ¶ˆæ¯ç±»ç»§æ‰¿`NetworkMessage`
3. åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„æ¶ˆæ¯å¤„ç†å™¨ä¸­æ·»åŠ å¤„ç†é€»è¾‘

---

## æ€§èƒ½ä¼˜åŒ–

### å®¢æˆ·ç«¯ä¼˜åŒ–
- é¢„åŠ è½½å’Œç¼“å­˜å›¾ç‰‡èµ„æº
- ä½¿ç”¨åŒç¼“å†²æŠ€æœ¯å‡å°‘ç•Œé¢é—ªçƒ
- å¼‚æ­¥å¤„ç†ç½‘ç»œæ¶ˆæ¯

### æœåŠ¡å™¨ä¼˜åŒ–
- ä½¿ç”¨çº¿ç¨‹æ± ç®¡ç†å¹¶å‘è¿æ¥
- åŠæ—¶æ¸…ç†æ–­å¼€çš„è¿æ¥
- æ¶ˆæ¯æ‰¹å¤„ç†å’Œå¼‚æ­¥å¤„ç†

---

## è°ƒè¯•æŠ€å·§

### å¯ç”¨è°ƒè¯•æ—¥å¿—

```bash
# å®¢æˆ·ç«¯
java -jar xiangqi-client.jar -d

# æœåŠ¡å™¨
java -jar xiangqi-server.jar -d
```

### å¸¸è§é—®é¢˜
- å¹¶å‘é—®é¢˜ï¼šä½¿ç”¨`synchronized`æˆ–`Lock`
- å†…å­˜æ³„æ¼ï¼šåŠæ—¶å…³é—­èµ„æº
- ç½‘ç»œè¶…æ—¶ï¼šè®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´

---

## ç‰ˆæœ¬æ§åˆ¶

### Gitå·¥ä½œæµ

- `main` - ç¨³å®šç‰ˆæœ¬
- `develop` - å¼€å‘ç‰ˆæœ¬
- `feature/*` - æ–°åŠŸèƒ½
- `hotfix/*` - ç´§æ€¥ä¿®å¤

### æäº¤è§„èŒƒ

```
type(scope): subject

feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
```

---

## ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®æ¦‚è¿°
- [QUICK_START.md](QUICK_START.md) - å¿«é€Ÿå¯åŠ¨
- [USER_GUIDE.md](USER_GUIDE.md) - ç”¨æˆ·æ‰‹å†Œ
- [CONFIG_README.md](CONFIG_README.md) - é…ç½®è¯´æ˜

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ğŸš€